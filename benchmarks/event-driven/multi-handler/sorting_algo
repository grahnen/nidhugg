extrace_WS(fst,snd,E){
 for(all events e of execution E){
  if(!(clock(e)>clock(fst))){
   notdep = notdep+e
  }
 }
 return (notdep+snd);
}
linearize_WS(fst,snd,WS){
 remove partial msgs and msgs that are happenning after first event of
 either first message or second message(except first and second message)
 trace = happens before of all the events
 don't include the race we are reversing in the trace
 reverse the racing edges
 for(race (e,fst)) put happens before from e to snd
 for(m in WS){
  add happens before from post(m) to post(snd)
 }
 for(e in WS){
  if(!visited(e)) visit(e)
 }
}
visit(e){
 for(e' happens before e){
  if(!visited(e')) visit(e')
 }
 if(e is post event)
  last_post = post event that posts to same handler
  m = msg posted by e
  m' = msg posted by last_post
  add happens before from m' to m
 }
 insert e to the sorted sequence
}
